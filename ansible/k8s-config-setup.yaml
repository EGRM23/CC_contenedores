---
- name: ğŸ“ Actualizar kubeconfig para EKS
  shell: |
    aws eks update-kubeconfig \
      --region {{ aws_region }} \
      --name {{ eks_cluster_name }}
  register: kubeconfig_result

- name: ğŸ” Verificar conexiÃ³n con cluster
  kubernetes.core.k8s_info:
    kind: Node
  register: nodes_info

- name: ğŸ“Š Mostrar informaciÃ³n del cluster
  debug:
    msg: |
      âœ… ConexiÃ³n exitosa con EKS Cluster:
      - Nodos disponibles: {{ nodes_info.resources | length }}
      - Cluster: {{ eks_cluster_name }}
      - RegiÃ³n: {{ aws_region }}

- name: ğŸ·ï¸ Crear namespace para la aplicaciÃ³n
  kubernetes.core.k8s:
    definition:
      apiVersion: v1
      kind: Namespace
      metadata:
        name: "{{ k8s_namespace }}"
        labels:
          name: "{{ k8s_namespace }}"
          project: "{{ project_name }}"