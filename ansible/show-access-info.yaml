---
- name: ğŸŒ Obtener informaciÃ³n del Load Balancer
  kubernetes.core.k8s_info:
    kind: Service
    namespace: ingress-nginx
    name: nginx-ingress-ingress-nginx-controller
  register: lb_info

- name: ğŸ‰ Mostrar informaciÃ³n de acceso
  debug:
    msg: |
      ğŸ‰ Â¡INFRAESTRUCTURA DESPLEGADA EXITOSAMENTE!

      âœ… RECURSOS CREADOS:
      - Cluster EKS: {{ eks_cluster_name }}
      - Namespace: {{ k8s_namespace }}
      - Pods: 5 (db, backend Ã—2, frontend Ã—2)
      - Servicios: 3
      - Ingress: 1

      ğŸŒ INFORMACIÃ“N DE ACCESO:
      {% if lb_info.resources[0].status.loadBalancer.ingress %}
      - Load Balancer: {{ lb_info.resources[0].status.loadBalancer.ingress[0].hostname }}
      - Frontend: http://{{ lb_info.resources[0].status.loadBalancer.ingress[0].hostname }}
      - Backend API: http://{{ lb_info.resources[0].status.loadBalancer.ingress[0].hostname }}/api
      {% else %}
      - Load Balancer: ConfigurÃ¡ndose... (puede tomar unos minutos)
      {% endif %}

      ğŸ”§ COMANDOS ÃšTILES:
      - Ver pods: kubectl get pods -n {{ k8s_namespace }}
      - Ver servicios: kubectl get svc -n {{ k8s_namespace }}
      - Ver logs backend: kubectl logs -l app=backend -n {{ k8s_namespace }}
      - Acceso a base de datos: kubectl exec -it deployment/db -n {{ k8s_namespace }} -- mysql -u root -p

      ğŸ“ˆ PARA ESCALAR:
      - Backend: kubectl scale deployment/backend --replicas=3 -n {{ k8s_namespace }}
      - Frontend: kubectl scale deployment/frontend --replicas=3 -n {{ k8s_namespace }}

      ğŸ—‘ï¸ PARA LIMPIAR:
      - Ejecutar: ansible-playbook -i inventory.yaml limpieza.yml