---
- name: ğŸ” Obtener informaciÃ³n de los nodos
  kubernetes.core.k8s_info:
    kind: Node
  register: nodes_info

- name: ğŸ‰ Mostrar informaciÃ³n de acceso
  debug:
    msg: |
      ğŸ‰ Â¡INFRAESTRUCTURA DESPLEGADA EXITOSAMENTE!

      âœ… RECURSOS CREADOS:
      - Cluster EKS: {{ eks_cluster_name }}
      - Namespace: {{ k8s_namespace }}
      - Pods: 5 (db, backend x2, frontend x2)
      - Servicios: 3 (2 NodePort, 1 ClusterIP)

      ğŸŒ INFORMACIÃ“N DE ACCESO (NodePort):
      {% if nodes_info.resources %}
      - Nodo: {{ nodes_info.resources[0].status.addresses[0].address }}
      - Frontend: http://{{ nodes_info.resources[0].status.addresses[0].address }}:30080
      - Backend API: http://{{ nodes_info.resources[0].status.addresses[0].address }}:30081
      {% else %}
      - Nodos: Obteniendo informaciÃ³n...
      {% endif %}

      ğŸ”§ COMANDOS ÃšTILES:
      - Ver pods: kubectl get pods -n {{ k8s_namespace }}
      - Ver servicios: kubectl get svc -n {{ k8s_namespace }}
      - Ver nodos: kubectl get nodes -o wide
      - Port-forward temporal: kubectl port-forward -n {{ k8s_namespace }} service/frontend 8080:80

      ğŸ¯ ACCESO RÃPIDO:
      # Port-forward para desarrollo
      kubectl port-forward -n {{ k8s_namespace }} service/frontend 8080:80 &
      kubectl port-forward -n {{ k8s_namespace }} service/backend 8081:3000 &
      # Luego acceder a:
      # Frontend: http://localhost:8080
      # Backend: http://localhost:8081

      ğŸ“ˆ PARA ESCALAR:
      - Backend: kubectl scale deployment/backend --replicas=3 -n {{ k8s_namespace }}
      - Frontend: kubectl scale deployment/frontend --replicas=3 -n {{ k8s_namespace }}

      ğŸ—‘ï¸ PARA LIMPIAR:
      - Ejecutar: ansible-playbook -i inventory.yaml cleanup/cleanup-nodegroup.yaml