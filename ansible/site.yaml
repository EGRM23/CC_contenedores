---
- name: ğŸš€ Desplegar Infraestructura Completa en AWS EKS
  hosts: localhost
  connection: local
  gather_facts: false
  vars_files:
    - group_vars/all.yaml
    - group_vars/aws.yaml

  tasks:
    - name: ğŸ“‹ Verificar credenciales AWS
      debug:
        msg: "ğŸš€ Iniciando despliegue en AWS regiÃ³n: {{ aws_region }}"

    - name: ğŸ—ï¸ Crear infraestructura base AWS
      include_tasks: aws-infra-setup.yaml

    - name: â˜¸ï¸ Crear cluster EKS
      include_tasks: aws-eks-setup.yaml

    - name: â³ Esperar que cluster EKS estÃ© listo
      pause:
        minutes: 3
        prompt: "Esperando que el cluster EKS estÃ© completamente disponible..."

    - name: ğŸ”§ Configurar acceso a cluster EKS
      include_tasks: k8s-config-setup.yaml

    - name: ğŸš€ Desplegar aplicaciÃ³n en Kubernetes
      include_tasks: k8s-deployment.yaml

    - name: ğŸŒ Configurar Ingress y DNS
      include_tasks: k8s-ingress-setup.yaml

    - name: ğŸ“Š Verificar despliegue
      include_tasks: k8s-verification.yaml

    - name: ğŸ‰ Mostrar informaciÃ³n de acceso
      include_tasks: show-access-info.yaml